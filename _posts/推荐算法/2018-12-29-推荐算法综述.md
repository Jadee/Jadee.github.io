---
title: 推荐算法综述
date: 2018-12-29
categories:
- 推荐算法
tags:
- 推荐系统
---

# 背景

本文主要介绍推荐系统中传统机器学习算法与深度学习算法，写这篇文章的主要目的是对业界主流推荐算法的一些总结，让读者对主流推荐算法的底层实现有一定了解，从而在业务实践过程中更好地理解算法，运用算法。

<!-- more -->

文章总共分3部分，第1部分为传统机器学习算法的介绍，第2部分是深度学习基础知识介绍，第3部分是深度学习推荐算法的介绍。

其中，传统机器学习算法总共介绍了10种推荐算法，深度学习介绍了14种方法

# 传统机器学习算法

本章节将介绍10种常见的推荐算法，并且列举一些实际的例子，详细介绍如下：

### 基于CF的推荐算法

#### 算法简介

CF（协同过滤）简单来形容就是利用兴趣相投的原理进行推荐，协同过滤主要分两类，一类是基于物品的协同过滤算法，另一种是基于用户的协同过滤算法，这里主要介绍基于物品的协同过滤算法。

给定一批用户，及一批物品，记 $V_i$ 表示不同用户对物品的评分向量，那么物品 $i$ 与物品 $j$ 的相关性为：

$$ sim(i, j) = cos(\vec{V_i}, \vec{V_j}) = \frac{\vec{V_i} \cdot \vec{V_j}}{\| \vec{V_i} \| \|\vec{V_j}\|} $$

上述公式是利用余弦公式计算相关系数，相关系数的计算还有：杰卡德相关系数、皮尔逊相关系数等

计算用户 $u$ 对某一物品的偏好，记用户 $u$ 对物品 $i$ 的评分为 $score(u,i)$，用户 $u$ 对物品 $i$ 的协同过滤得分为 $rec(u,j)$。

$$ rec(u, j) = \sum_{i=1}^n score(u, j) \cdot sim(i, j) $$

#### 业务实践

以购物篮子为例，业务问题：根据用户的历史购买商品记录，给用户推荐一批商品。协同过滤算法实现方法如下。

* Step1：计算物品之间的相关系数

&emsp;&emsp;记 $buyers_i$ 表示用户购买商品的向量，记 $buyers_i = (\ldots, b_{u,i}, \ldots), u \in U$，其中 $U$ 表示全库用户集合，$b_{u，i}$ 表示用户 $u$ 对商品 $i$ 的得分，定义如下：

$$ b_{u,i} = \left\{
\begin{array}{rcl}
0       &      & {表示没有购买}\\
\frac{1}{\alpha t}       &      & {其中t表示购买距离现在天数，\alpha 表示时间衰减系数}
\end{array} \right. 
$$

&emsp;&emsp;那么商品 $i$ 与商品 $j$ 的相关系数如下：

$$ sim(i,j) = \frac{buyers_i \cdot buyers_j }{\| buyers_i\| \| buyers_j\|} $$

&emsp;&emsp;上述公式是是利用余弦公式计算相关性，含义是商品的用户购买向量夹角越小越相似。此外也可以运用皮尔逊、杰卡德、自定义公式计算相关性，这里不一一列举。

* Step2：计算用户对商品的协同过滤得分

&emsp;&emsp;给定一个用户 $u$，设该用户历史购买商品记录的向量为 $history_i = (\ldots, h_{u,i}, \ldots), i \in I$，其中 $I$ 表示所有商品的集合。

$$ h_{u, i} = \frac{1}{\alpha t}$$

&emsp;&emsp;计算给定一个物品j的协同过滤得分为:

$$ rec(u,j) = \sum_{i=1}^n h_{u,i} \cdot sim(i,j)$$

* step3：给用户推荐商品

&emsp;&emsp;通过Step2计算用户对全库商品的协同过滤得分，取得分top 10展示给用户

### 基于关联规则的推荐算法

#### 算法简介

基于关联规则的推荐是根据历史数据统计不同规则出现的关系，形如：X->Y，表示X事件发生后，Y事件会有一定概率发生，这个概率是通过历史数据统计而来。

对于一个规则X->Y，有两个指标对该规则进行衡量。一个是支持度，表示在所有样本数据中，同时包含X和Y样本的占比。另一个是置信度，表示在所有包含X的样本中，包含Y的样本占比。

在关联推荐算法中，最主要的是如何找到最大频繁项，业界主要的做法有两种，分别为Apriori算法和FP树。但在互联网海量的用户特征中，使用这些算法挖掘频繁集计算复杂度非常高，下面我们介绍一种在业务当中简单实用的关联规则算法。

#### 业务实践

同样是以购物篮子为例，业务场景是：根据用户历史购物记录，给用户推荐商品。下面我们介绍如何构建简单的关联规则推荐算法。

* Step1：数据准备

首先收集用户展示购买记录，并且关联用户在展示时刻的特征数据。设总样本数量为n条，数据格式如下：

| 样本序号 | 用户 | 特征 | 商品 | 用户是否购买（0表示否，1表示是）|
| 1 | $u_1$ | $f_{1,1}，f_{1,2}，\ldots$| $i_1$ | $b_n$ |
| $\ldots$ | $\ldots$ | $\ldots$ | $\ldots$ | $\ldots$ |
| n | $u_n$ | f_{n,1}，f_{n,2}，\ldots$ | $i_n$ | $b_n$ |

其中用户特征可以是用户历史购买的商品ID，也可以是用户属性特征，例如：年龄、性别、居住地等等。

* Step2：特征交叉

在上表中，对于同一个样本所有特征两两交叉，生成长度为2的特征规则，合并原来的长度为1的特征规则，得到关联规则数据输入表如下：


