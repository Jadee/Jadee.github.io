---
title: 基于贝叶斯概率风险决策的预算分配方法
date: 2019-03-03
categories: 计算广告
tags:
- 计算广告
- Pacing
---

# 背景

关于 pacing 的背景内容，之前一篇文章有介绍，详细参见:https://jadee.github.io/计算广告/2019/03/02/pacing优化技术/

在之前的系统中很核心的两个系统是影子系统和基于 replay 的模拟系统，前者用以实现撞线计划全天所有候选 auction 的记录，以及当次竞价场景的记录，后者用以模拟完整的线上逻辑求解 pacing 参数，二者是支撑 pacing1.0 功能实现和上线的两个重要的子系统

实际上线后存在两个比较大的问题:

* 影子系统的维护成本

*运维成本:* 影子系统除了撞线计划保留在线状态继续参与竞价之外，要求和线上系 统完全一致，包括策略版本和索引数据更新，增加线上一致性保证的运维成本，且策略或者数据不一致对效果存在较大影响风险

*机器成本: *一套完整的系统需要搭建完整的引擎各模块。

* 模拟预估系统的效果瓶颈

效果预估是 pacing 参数求解的核心，预估准确率直接影响项目整体效果，pacing 1.0 效果强依赖模拟系统的精度，模拟系统简单理解是对线上投放策略的完整回放，而线上排序系统经常发生变更，而且复杂程度也越来越高，基于模拟的预估系统已经很难持续迭代升级保证精确的模拟真实线上投放，并且这种回放预估的准确率提升优化难度大，不适宜继续基于此系统共优化

因此 pacing 2.0 期望通过概率预估模型实现效果预估，解耦影子系统解决维护成本问题，同时效果预估优化提供可持续迭代空间，提升效果的 upbound

# 问题定义

pacing 问题可以定义为分配问题：

分配问题，客户授权的前提下，使用一定的策略控制预算受限的 campaign 参与或放弃一部分竞价，达到效用最大化的目的。

在做分配之前，我们需要知道一些信息，第一，campaign 预算 ，这很容易知道，第二，候选 auction 集，即未来能够获得展现的 auction 集合。

候选 auction 集可以表达如下：$S = {a_1, a_2, ..., a_n}$， $a_i$表示候选 auction 集的二元组信息，即 $a_i = (c_i, p_i)$， $c_i$表示候选 auction 的期望 cost， $p_i$表示候选 auction 的期望 performance。 

$c_i$可以通过 $c_i = cpc_i * pctr_i$ 来计算，performance $p_i$ 这里使用成交额，即 $p_i = pctr_i * pcvr_i * price_i$ ， 表示搜索引擎给 ad 预估的转化率， 表示 ad 的笔单价。需要再次说明的是，候选 auction 集的含义是指能够获得展现的 auction 集合，即 ，因此，它包含了两方面信息：1）大盘的搜索量，2）campaign 的展现概率
