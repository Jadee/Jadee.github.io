---
title: 品牌合约广告(2)
date: 2019-10-23
categories: 计算广告
tags:
- 计算广告
- 合约广告
---

# 项目背景

品牌广告投放分配优化，目的是设计一种合理的分配机制，为每个请求对应的资源位展示分配对应的展示广告，以完成品牌广告订单的展示量要求，并在此前提下最大化广告转化效果点击率。

不同于一般效果广告只追求点击率最大化的要求，品牌广告的首要目标是完成广告主的合约保量需求，因此针对效果广告中点击率优化的神经网络、强化学习等算法在品牌广告分配模型中的往往很难直接落地应用。

# 项目目标

针对品牌广告合约保量的要求，在品牌广告保量的前提下，或者说是在保证品牌广告的订单完成率不低于一定阈值的前提下，最大化合约广告的点击率。
# 算法方案

基于已有的SHALE算法框架进行求解，对于最大化点击率的目标，在模型的目标函数中增加最大化click项，建立分配模型：

##分配模型

$$ \min \;\;\; \frac{1}{2}\sum_{j,i\in\Gamma(j)}s_i\frac{V_j}{\theta_j}(x_{ij}-\theta_j)^2-\sum_{j,i\in\Gamma(j)}s_ix_{ij}-\lambda\sum_{j,i\in\Gamma(j)}s_ix_{ij}c_{ij}\\ $$

$$
\begin{align} s.t. \;\;\; & \sum_{i\in\Gamma(j)}s_ix_{ij}\le d_j,\;\;\forall j \\
& \sum_{j\in\Gamma(i)}x_{ij}\le1,\;\;\forall i \\
& s_ix_{ij}\le f_j,\;\;\forall i,j \\
& x_{ij} \ge 0, \;\; \forall i,j \\
\end{align}
$$

目标函数中第一项为平滑项，目的是实现广告在各supply上的均匀投放，避免一味追求保量或效果最大出现集中小部分supply投放的情况；第二项是pv投放总量，即最大化pv总量；第三项是click总量，权重值用于在保量和效果两个目标之间实现均衡。

第一个约束限制了每个demand都不能出现超过预定量的投放，这一约束避免了为到达更多的click数量而超量投放的情况，而由于目标函数中有最大化投放总量这一项，因此仍然可以保证缺量风险最小这一目标；第二个约束为供给侧约束，对于淘系品牌展示广告，一个supply节点上最多只能投放一个广告。

## 算法原理

采用拉格朗日对偶方法，根据KKT条件，最优投放概率 $x_{ij}=\min\{\frac{f_j}{s_i},\max\{0,\theta_j(1+\frac{1+\lambda c_{ij}-\alpha_j-\beta_i}{v_j})\}\}$，其中 $\alpha_j$ 和 $\beta_i$ 分别为模型中第一个和第二个约束对应的拉格朗日对偶变量。为得到最优解 $x_ij$
