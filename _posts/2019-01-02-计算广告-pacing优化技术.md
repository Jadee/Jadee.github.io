---
title: 计算广告-pacing优化技术
date: 2019-01-02
categories: 计算广告
tags:
- 计算广告
- Pacing
- github
---

# 背景
广告系统是用户、广告主、平台三方博弈的生态。用户希望通过搜索词（或者浏览）找到符合自己意图得信息或商品，广告主则希望通过投放策略的优化找到更精准的用户实现投放效果的优化，平台是连接消费者和广告主的桥梁，帮助广告主匹配到合适的用户实现投放诉求，实现流量变现效率最大化。

广告平台核心包含两个子平台，demand 端和 supply 端，supply 端面向平台，实现广告的在线分配，目标是优化分配效率，以在保证相关性用户体验下实现流量变现效率最大化为目标；而 demand 端优化是面向广告主，通过提供各种工具帮助广告主优化投放效率和效果。

影响广告主投放效果的因素有很多，其中预算（budget）是广告主控制花费，调节效果与花费的重要抓手。直通车的账户结构是，一个账户（cust）下有多个计划（campaign），每个计划下有多个推广单元（adgroup），预算是设置在计划维度，代表该计划当天（24h）允许的花费上限，在达到预算日限额后，整个广告计划将下线。
预算花费策略而言，在广告主手动控制下，只能设置一定的价格，按照时间顺序参与所有流量的竞争，拿到获胜的流量，而无法实现优中选优的有利策略，实现预算花费效率最大化。同时对于预算不足的计划，预算花费速度不合理将带来如下问题：
1. 预算在每天初期消耗殆尽，无法参与后期竞价，每天后半天的优质流量无法触达
2. 人群覆盖不全，对TA人群分析和客户拉新不利
3. 从成交额角度看无法实现当前限定预算下效果最优

预算花费控制优化是 demand 端帮助广告主优化投放效果的重要手段，我们称之为 pacing，其核心目标是解决预算不足撞线客户的预算花费控制问题，在限定预算约束条件下，帮助广告主全局优选最优质的流量，实现campaign当前设置下成交额最大化，同时提升客户在线时长，提升受众触达和人群覆盖，提升店铺基于人群的效果优化效率，另外通过 pacing 全局控制对平台来说，可以平滑全天的竞争程度，长期来看有利于生态的健康发展。

# 意义
pacing 的意义显而易见：

1. 提升客户在线时长，扩大受众面
2. 竞争程度相对均衡，长期来看利于生态健康发展
3. 有选择性的投放，提升客户的效果（成交额）

# 技术方案
pacing 的常用手段为 throttling 和 biding，throttling 控制每次 pv 参不参与竞价，biding 控制每次 pv 的出价。

## throttling 方案
throttling 思路简单，pacing 帮助预算不足的 campaign 选择一部分差的 pv 放弃竞价，使得剩下的优质 pv 刚好花完预算。

### 建模
站在 campaign 视角，选择最好的 pv，建模方式如下：
$$ \mathsf{max}\_{x} \sum_{i = 1} p_i * x_i $$

## biding 方案
